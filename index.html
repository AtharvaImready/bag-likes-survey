<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta charset="utf-8">
<title>Bag Likes Survey</title>

<!-- Swiper CSS -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"
/>

<style>
  /* Global & Layout Styles */
  body { font-family: Arial, sans-serif; background:#f7f7f7; margin:0; padding:12px; }
  
  /* Header Styles */
  .header { text-align: center; margin-bottom: 20px; }
  .header h1 { color: black !important; margin-bottom: 8px; }
  .header p { color:  black !important; margin-top: 0; }
  
  /* Bag Container Styles */
  .bag-container { 
    background:white; 
    border-radius:10px; 
    box-shadow:0 2px 8px rgba(0,0,0,0.08); 
    margin-bottom:16px; 
    overflow:hidden; 
    max-width:520px; 
    margin-left:auto; 
    margin-right:auto; 
    padding:10px; 
  }
  
  /* Like Button Styles */
  .like-btn { 
    font-size:20px; 
    border:none; 
    background:transparent; 
    cursor:pointer; 
    padding:6px 10px; 
  }
  .like-btn.liked { 
    color:#ff4d6d; 
    font-weight:700; 
  }
  .likes-count { 
    font-size:16px; 
    color:#333; 
    margin-left:8px; 
  }
  
  /* Swiper Styles */
  h3 { margin-bottom:8px; }
  .swiper { width: 100%; height: 300px; }
  .swiper-slide img { 
    width: 100%; 
    height: 100%; 
    object-fit: contain; 
    display: block; 
  }
  .controls { 
    display:flex; 
    align-items:center; 
    justify-content:flex-start; 
    padding-top:10px; 
  }
  .swiper-button-next,
  .swiper-button-prev {
      background-color: rgba(160, 160, 160, 0.8); /* Gray background */
      color: white; /* White arrow */
      width: 25px;
      height: 25px;
      border-radius: 50%; /* Circle shape */
      display: flex;
      align-items: center;
      justify-content: center;
   }

   .swiper-button-next::after,
   .swiper-button-prev::after {
      font-size: 10px; /* Arrow size */
      font-weight: bold; /* bold arrow */
      margin: 0 !important; /* remove extra offset */
      position: static !important; /* stop absolute positioning */
  }

  .swiper-button-next {
      right: 10px; /* Adjust right position */
  }

  .swiper-button-prev {
      left: 10px; /* Adjust left position */
  }

/* ===== SURVEY CONTAINER ===== */
.survey-questions {
  background: white;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  max-width: 520px;
  margin: 20px auto;
  padding: 25px; /* Increased padding */
}

/* ===== QUESTION STYLES ===== */
.survey-question {
  font-weight: bold;
  margin-bottom: 20px; /* Increased space below questions */
  color: #333;
  padding-bottom: 15px;
  border-bottom: 1px solid #f0f0f0; /* Subtle divider */
}

/* ===== OPTIONS CONTAINER ===== */
.survey-options {
  display: flex;
  flex-direction: column; /* Vertical layout */
  gap: 10px; /* Consistent spacing between options */
  margin: 15px 0 25px;
}

/* ===== INDIVIDUAL OPTION ===== */
.survey-option {
  display: flex;
  align-items: center;
  padding: 12px 15px;
  background-color: #f9f9f9;
  border-radius: 6px;
  transition: all 0.2s;
  cursor: pointer;
}

.survey-option:hover {
  background-color: #f0f0f0;
}

.survey-option input[type="radio"] {
  margin-right: 12px;
  accent-color: #ff4d6d;
  width: 16px;
  height: 16px;
  cursor: pointer;
}

/* ===== SUBMIT BUTTON ===== */
.survey-submit-btn {
  background-color: #87CEFA; /* Light sky blue */
  color: #333;
  border: none;
  padding: 14px 24px; /* Slightly taller */
  border-radius: 5px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  display: block;
  width: 100%;
  margin: 30px auto 0;
  transition: background-color 0.3s;
}

.survey-submit-btn:hover {
  background-color: #6CB4EE; /* Darker sky blue */
}

  /* HEADER SECTION STYLING */
.header-section {
    /* Your uploaded image URL — replace 'your-image-path.png' with the actual path */
    background-image: url('https://raw.githubusercontent.com/AtharvaImready/bag-likes-survey/main/images/bag-bg-site.jpg');
    background-size: cover; /* Make the image fill the section */
    background-position: center -50px ; /* Center the image */
    background-repeat: no-repeat; /* Avoid repeating the image */
    padding: 20px;

    position: relative; /* Needed for overlay */
    padding: 40px 20px; /* Space around the text */
    text-align: center; /* Center text horizontally */
    
  }

/* OPTIONAL — dark overlay to make text pop */
 .header-section::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.4); /* Black with 40% transparency */
    z-index: 0; /* Keep overlay behind text */
  }

/* Make sure text is above overlay */
.header-section h1,
.header-section p {
    position: relative;
    z-index: 1;
    color: black; 
    text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.6); /* Shadow for readability */
 }

</style>
</head>
<body>

<!-- Added Header Section -->
<!-- HEADER SECTION START -->
<div class="header-section">
    <h1>Bag Preference Survey</h1>
    <p>Please select the bags you would consider buying and answer a few quick questions.</p>
</div>
<div id="bags"></div>

<!-- Survey Questions Section -->
<div class="survey-questions">
  <div class="survey-question">
    <div class="survey-question-title">1. What is your age group?</div>
    <div class="survey-options">
      <label class="survey-option"><input type="radio" name="age" value="18-21"> 18–21 years</label>
      <label class="survey-option"><input type="radio" name="age" value="22-25"> 22–25 years</label>
      <label class="survey-option"><input type="radio" name="age" value="26-29"> 26–29 years</label>
      <label class="survey-option"><input type="radio" name="age" value="30-33"> 30–33 years</label>
    </div>
  </div>

  <div class="survey-question">
    <div class="survey-question-title">2. How often do you buy new bags?</div>
    <div class="survey-options">
      <label class="survey-option"><input type="radio" name="frequency" value="weekly"> Weekly</label>
      <label class="survey-option"><input type="radio" name="frequency" value="monthly"> Monthly</label>
      <label class="survey-option"><input type="radio" name="frequency" value="yearly"> Yearly</label>
      <label class="survey-option"><input type="radio" name="frequency" value="rarely"> Rarely</label>
    </div>
  </div>

  <div class="survey-question">
    <div class="survey-question-title">3. What's most important when choosing a bag?</div>
    <div class="survey-options">
      <label class="survey-option"><input type="radio" name="priority" value="price"> Price</label>
      <label class="survey-option"><input type="radio" name="priority" value="design"> Design</label>
      <label class="survey-option"><input type="radio" name="priority" value="brand"> Brand</label>
      <label class="survey-option"><input type="radio" name="priority" value="durability"> Durability</label>
    </div>
  </div>
  
  <div class="survey-question">
    <div class="survey-question-title">4. What price range would you be willing to spend on a bag?</div>
    <div class="survey-options">
      <label class="survey-option"><input type="radio" name="price" value="under-1000"> Under ₹1,000</label>
      <label class="survey-option"><input type="radio" name="price" value="1000-2500"> ₹1,000 – ₹2,500</label>
      <label class="survey-option"><input type="radio" name="price" value="2500-5000"> ₹2,500 – ₹5,000</label>
      <label class="survey-option"><input type="radio" name="price" value="5000-10000"> ₹5,000 – ₹10,000</label>
      <label class="survey-option"><input type="radio" name="price" value="above-10000"> Above ₹10,000</label>
    </div>
  </div>

  <button type="button" id="survey-submit-btn" class="survey-submit-btn">Submit</button>

</div>


<!-- Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbxlNzdbQ3UzygYs5i5A1TNTj4zfIhyt_Zy5qH0Ud8sMh16bmIH6tQz-m86pPV1Gbc0LKg/exec"; // <-- REPLACE

const bagsData = [
  { id: "b00", images: ["images/b00.jpg", "images/b00_1.jpg", "images/b00_2.jpg"] },
  { id: "b01", images: ["images/b01.jpg", "images/b01_1.jpg", "images/b01_2.jpg"] },
  { id: "b02", images: ["images/b02.jpg", "images/b02_1.jpg", "images/b02_2.jpg"] },
  { id: "b03", images: ["images/b03.jpg"] },
  { id: "b04", images: ["images/b04.jpg"] }
];

async function fetchInitialLikes() {
  try {
    const res = await fetch(scriptURL);
    if (!res.ok) throw new Error('Failed to fetch likes');
    return await res.json();
  } catch (err) {
    console.error('Error fetching likes:', err);
    return {};
  }
}

function renderBags(likesMap) {
  const container = document.getElementById('bags');
  container.innerHTML = '';

  bagsData.forEach((bag, index) => {
    const alreadyLiked = !!localStorage.getItem('liked_' + bag.id);

    const bagDiv = document.createElement('div');
    bagDiv.className = 'bag-container';

    // Title
    const title = document.createElement('h3');
    title.innerText = `Bag ID: ${bag.id}`;
    bagDiv.appendChild(title);

    // Swiper container unique class/id to avoid conflicts
    const swiperContainer = document.createElement('div');
    swiperContainer.className = 'swiper';
    swiperContainer.id = 'swiper-' + index;

    // Swiper wrapper
    const swiperWrapper = document.createElement('div');
    swiperWrapper.className = 'swiper-wrapper';

    bag.images.forEach(src => {
      const slide = document.createElement('div');
      slide.className = 'swiper-slide';

      const img = document.createElement('img');
      img.src = src;
      slide.appendChild(img);

      swiperWrapper.appendChild(slide);
    });

    swiperContainer.appendChild(swiperWrapper);

    // Navigation buttons
    const btnPrev = document.createElement('div');
    btnPrev.className = 'swiper-button-prev';
    swiperContainer.appendChild(btnPrev);

    const btnNext = document.createElement('div');
    btnNext.className = 'swiper-button-next';
    swiperContainer.appendChild(btnNext);

    // Pagination
    const pagination = document.createElement('div');
    pagination.className = 'swiper-pagination';
    swiperContainer.appendChild(pagination);

    bagDiv.appendChild(swiperContainer);

    // Controls (like button + count)
    const controls = document.createElement('div');
    controls.className = 'controls';

    const likeBtn = document.createElement('button');
    likeBtn.className = 'like-btn' + (alreadyLiked ? ' liked' : '');
    likeBtn.innerHTML = '❤️';

    const likesCountEl = document.createElement('span');
    likesCountEl.className = 'likes-count';
    likesCountEl.innerText = (likesMap[bag.id] || 0);

    likeBtn.onclick = () => likeBag(bag.id, likeBtn, likesCountEl);

    controls.appendChild(likeBtn);
    controls.appendChild(likesCountEl);

    bagDiv.appendChild(controls);

    container.appendChild(bagDiv);

    // Initialize swiper for this bag
    new Swiper('#' + swiperContainer.id, {
      loop: true,
      navigation: {
        nextEl: '#' + swiperContainer.id + ' .swiper-button-next',
        prevEl: '#' + swiperContainer.id + ' .swiper-button-prev',
      },
      pagination: {
        el: '#' + swiperContainer.id + ' .swiper-pagination',
        clickable: true,
      },
    });
  });
}
async function likeBag(bagID, btnEl, likesEl) {
  const likedKey = 'liked_' + bagID;
  let currentLikes = parseInt(likesEl.innerText) || 0;

  if (localStorage.getItem(likedKey)) {
    // Unlike action
    likesEl.innerText = Math.max(0, currentLikes - 1);
    btnEl.classList.remove('liked');
    localStorage.removeItem(likedKey);

    try {
      await fetch(scriptURL, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ bagID: bagID, action: 'unlike' })
      });
    } catch (err) {
      console.error('Error posting unlike:', err);
    }
  } else {
    // Like action
    likesEl.innerText = currentLikes + 1;
    btnEl.classList.add('liked');
    localStorage.setItem(likedKey, '1');

    try {
      await fetch(scriptURL, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ bagID: bagID, action: 'like' })
      });
    } catch (err) {
      console.error('Error posting like:', err);
    }
  }
}



(async () => {
  const likesMap = await fetchInitialLikes();
  renderBags(likesMap);
})();
</script>

  
  <script>
document.getElementById("survey-submit-btn").addEventListener("click", function() {
    // Here you can also run your form submission logic if needed

    // Change text
    this.textContent = "Submitted ✅";
    // Disable button
    this.disabled = true;
    // Save state in localStorage so it remembers next time
    localStorage.setItem("surveySubmitted", "true");
});

// On page load, check if already submitted
window.addEventListener("load", function() {
    if (localStorage.getItem("surveySubmitted") === "true") {
        let btn = document.getElementById("survey-submit-btn");
        btn.textContent = "Submitted ✅";
        btn.disabled = true;
    }
});
</script>

</body>
</html>
